<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>PetTracker Pro</title>
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css" rel="stylesheet" />
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: 'Segoe UI', sans-serif;
        }
        #map { 
            position: absolute; 
            top: 0; 
            bottom: 0; 
            width: 100%; 
        }

        /* Floating status panel */
        .status-panel {
            position: fixed;
            top: 150px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1;
            min-width: 200px;
        }

        /* Header styling */
        .header {
            background: #2c3e50;
            color: white;
            padding: 15px 25px;
            position: relative;
            z-index: 2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* Custom marker styling */
        .mapboxgl-marker {
            transition: all 0.3s ease;
        }

        /* Loading spinner */
        .loader {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            z-index: 1000;
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Battery status indicator */
        .battery {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            background: #e74c3c;
            color: white;
            font-size: 0.9em;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>PetTracker Pro üêæ</h1>
        <div class="battery">Battery: 82%</div>
    </div>

    <div id="map"></div>
    
    <!-- Status Panel -->
    <div class="status-panel">
        <h3>Current Status</h3>
        <p>Last Update: <span id="last-update">Just now</span></p>
        <p>Coordinates: 
            <span id="coordinates">0.0000, 0.0000</span>
        </p>
    </div>

    <!-- Loading Spinner (initial state) -->
    <div class="loader" id="loader"></div>

    <script>
        // Existing code remains unchanged
        mapboxgl.accessToken = 'pk.eyJ1Ijoid2l6YXJkLTIxIiwiYSI6ImNtNnFkdXE0ODFjcnkyaXE4cDNkc3k4dmcifQ.q5oVD2NW9WkVH5pb5tyODw';

        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [0, 0],
            zoom: 12
        });

        var marker = new mapboxgl.Marker({
            color: '#e74c3c', // Red color for better visibility
            scale: 1.2
        })
        .setLngLat([0, 0])
        .addTo(map);

        async function getPetLocation() {
            try {
                document.getElementById('loader').style.display = 'block';
                const response = await fetch('https://4rvuhbvv8f.execute-api.us-east-1.amazonaws.com/prod/GetPetLocation');
                const data = await response.json();

                if (data && data.longitude && data.latitude) {
                    const newLongitude = data.longitude;
                    const newLatitude = data.latitude;

                    marker.setLngLat([newLongitude, newLatitude]);
                    map.setCenter([newLongitude, newLatitude]);
                    
                    // Update status panel
                    document.getElementById('coordinates').textContent = 
                        `${newLatitude.toFixed(4)}, ${newLongitude.toFixed(4)}`;
                    document.getElementById('last-update').textContent = 
                        new Date().toLocaleTimeString();
                }
                document.getElementById('loader').style.display = 'none';
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loader').style.display = 'none';
            }
        }

        setInterval(getPetLocation, 5000);
        getPetLocation();
    </script>
</body>
</html>